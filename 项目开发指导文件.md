# 健身房多品牌管理SaaS系统 - 项目开发指导文件

## 📋 项目概述

### 项目名称
健身房多品牌管理SaaS系统

### 项目定位
构建一套**多品牌、多门店、多角色、多终端**的健身房数字化管理系统，实现会员服务、门店管理、品牌管理与总部运营的一体化。

### 核心特点
- 🏢 **多品牌架构**：支持多个健身品牌独立运营
- 🏪 **多门店管理**：每个品牌可管理多个门店
- 👥 **多角色权限**：会员、教练、前台、门店管理者、品牌管理者、总部管理者
- 📱 **多终端支持**：小程序（会员端、门店端）+ Web（门店端、总部端）

---

## 🏗️ 系统架构

### 整体架构图
```
┌─────────────────────────────────────────┐
│              总部 Web 管理端               │
│        (品牌管理 + 全局数据分析)            │
└─────────────────┬───────────────────────┘
                  │ 数据汇总 / 权限管理
┌─────────────────┴───────────────────────┐
│              品牌管理端 (Web)             │
│         (品牌旗下所有门店管理)              │
└─────────────────┬───────────────────────┘
                  │ 多品牌数据分发
┌─────────────────┴───────────────────────┐
│              门店管理端                   │
│  ┌─────────────────┬─────────────────┐  │
│  │  Web完整功能版   │  小程序简化版    │  │
│  │  (门店管理者)    │  (教练/前台)    │  │
│  └─────────────────┴─────────────────┘  │
└─────────────────┬───────────────────────┘
                  │ 会员服务接口
┌─────────────────┴───────────────────────┐
│              会员端小程序                 │
│         (统一会员服务入口)                │
└─────────────────────────────────────────┘
```

### 技术架构

#### 前端技术栈
- **小程序端**：微信小程序原生开发
  - 会员端小程序
  - 门店端小程序（简化版）
- **Web端**：现代前端框架
  - 推荐：Vue.js 3 + TypeScript + Vite
  - 或：React 18 + TypeScript + Next.js
  - UI组件库：Element Plus / Ant Design

#### 后端技术栈（推荐方案）

##### 🚀 核心框架选择：Node.js + NestJS
**选择理由**：
- **TypeScript原生支持**：与前端技术栈统一，降低学习成本
- **装饰器架构**：优雅的依赖注入和模块化设计
- **微服务友好**：内置微服务支持，适合多品牌架构
- **生态丰富**：丰富的第三方库和中间件
- **开发效率高**：快速原型开发和迭代

##### 🗄️ 数据库架构
```
主数据库：PostgreSQL 14+
├── 优势：ACID事务、JSON支持、扩展性强
├── 适用：核心业务数据、用户信息、财务数据
└── 配置：主从复制 + 读写分离

缓存层：Redis 7+
├── 会话存储：用户登录状态、权限缓存
├── 数据缓存：热点数据、统计结果
├── 消息队列：异步任务处理
└── 分布式锁：并发控制

搜索引擎：Elasticsearch 8+
├── 会员搜索：姓名、手机号模糊搜索
├── 课程搜索：课程名称、教练搜索
└── 日志分析：系统日志、用户行为分析
```

##### 🔧 核心技术组件
- **API设计**：RESTful API + GraphQL（复杂查询）
- **认证授权**：JWT + RBAC权限模型
- **数据验证**：class-validator + class-transformer
- **ORM框架**：TypeORM（支持多数据库）
- **文档生成**：Swagger/OpenAPI 3.0
- **测试框架**：Jest + Supertest

##### 📁 文件存储策略
```
云存储：阿里云OSS / 腾讯云COS
├── 用户头像：压缩存储，CDN加速
├── 课程图片：多尺寸存储
├── 合同文件：加密存储，权限控制
└── 系统备份：定期备份，异地容灾

本地缓存：Redis + 本地文件系统
├── 临时文件：上传缓存、导出文件
└── 静态资源：小程序静态资源
```

##### 🔄 消息队列与异步处理
```
Redis Bull Queue
├── 会员通知：课程提醒、到期提醒
├── 数据统计：日报、月报生成
├── 文件处理：Excel导入导出
└── 第三方集成：微信消息推送
```

##### 🛡️ 安全架构
```
多层安全防护
├── 网络层：HTTPS + WAF防火墙
├── 应用层：JWT认证 + RBAC授权
├── 数据层：字段加密 + 访问审计
└── 监控层：异常检测 + 实时告警
```

##### 📊 监控与日志
- **APM监控**：New Relic / DataDog
- **日志收集**：Winston + ELK Stack
- **性能监控**：Prometheus + Grafana
- **错误追踪**：Sentry
- **健康检查**：内置健康检查端点

##### 🔄 备选方案：Java + Spring Boot
**适用场景**：
- 团队Java技术栈更熟悉
- 对性能要求极高的场景
- 需要复杂的事务处理

**技术栈**：
- Spring Boot 3.0 + Spring Security
- MyBatis-Plus / JPA
- Redis + RabbitMQ
- Maven / Gradle

#### 部署架构
- **云服务**：阿里云 / 腾讯云
- **容器化**：Docker + Kubernetes
- **负载均衡**：Nginx
- **监控**：Prometheus + Grafana

---

## 🎨 UI设计规范

### 小程序端设计风格

#### 毛玻璃悬浮效果
```css
/* 毛玻璃卡片样式 */
.glass-card {
  background: rgba(255, 255, 255, 0.85);
  backdrop-filter: blur(20px);
  border-radius: 16px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
}

/* 悬浮按钮 */
.floating-button {
  background: linear-gradient(135deg, #007AFF, #5856D6);
  backdrop-filter: blur(10px);
  border-radius: 50%;
  box-shadow: 0 4px 20px rgba(0, 122, 255, 0.3);
}
```

#### 色彩规范
- **主色调**：#007AFF（现代蓝）
- **辅助色**：#5856D6（紫色）
- **成功色**：#34C759（绿色）
- **警告色**：#FF9500（橙色）
- **错误色**：#FF3B30（红色）
- **背景色**：#F8F9FA（浅灰白）
- **文字色**：
  - 主要文字：#333333
  - 次要文字：#666666
  - 辅助文字：#999999

#### 设计原则
- **极简主义**：去除冗余元素，突出核心功能
- **大量留白**：提升视觉舒适度和内容可读性
- **圆角设计**：统一使用16px圆角，柔和视觉体验
- **渐变效果**：适度使用渐变色彩，增强现代感
- **微动效**：页面切换和交互反馈使用流畅动画

### Web端设计风格
- **现代扁平化**：简洁的管理界面设计
- **数据可视化**：图表和统计数据清晰展示
- **响应式布局**：适配不同屏幕尺寸

---

## 📱 功能模块详解

### 会员端小程序

#### 核心功能
- **会员服务**
  - 注册登录（微信授权）
  - 个人信息管理
  - 会籍卡查看和续费
- **课程管理**
  - 私教课程预约/取消
  - 团课课程预约/取消
  - 课程签到（扫码/定位）
- **教练服务**
  - 教练信息查看
  - 教练收藏和评价
  - 私教预约
- **体征记录**
  - 身体数据录入
  - 训练记录查看
  - 进度统计分析
- **消费记录**
  - 消费明细查看
  - 余额和次数查询

#### 页面结构
```
会员端小程序
├── 首页
│   ├── 个人信息卡片
│   ├── 快捷功能入口
│   └── 今日课程/活动
├── 课程
│   ├── 私教课程
│   ├── 团课课程
│   └── 课程历史
├── 教练
│   ├── 教练列表
│   ├── 教练详情
│   └── 我的教练
├── 体征
│   ├── 数据录入
│   ├── 历史记录
│   └── 统计分析
└── 我的
    ├── 个人信息
    ├── 会籍卡管理
    ├── 消费记录
    └── 设置
```

### 门店端小程序（简化版）

#### 核心功能
- **会员管理**
  - 新增会员
  - 会员信息查看
  - 会员签到管理
- **卡务管理**
  - 办理会籍卡
  - 续费操作
  - 卡务查询
- **课程管理**
  - 私教课程安排
  - 团课课程管理
  - 代理预约
- **签到管理**
  - 扫码签到
  - 手动签到
  - 签到记录

#### 页面结构
```
门店端小程序
├── 工作台
│   ├── 今日数据概览
│   ├── 快捷操作
│   └── 待办事项
├── 会员
│   ├── 会员列表
│   ├── 新增会员
│   └── 签到管理
├── 课程
│   ├── 私教课程表
│   ├── 团课课程表
│   └── 课程操作
└── 我的
    ├── 个人信息
    ├── 工作统计
    └── 设置
```

### Web门店端（完整功能）

#### 导航结构
```
Web门店端
├── 🏠 系统首页
│   ├── 门店概览仪表板
│   ├── 今日数据统计
│   └── 快捷操作入口
├── 👥 会员管理
│   ├── 会员信息管理
│   ├── 新增会员
│   ├── 会员卡管理
│   ├── 合同管理
│   └── 会员签到记录
├── 🏃‍♂️ 课程管理
│   ├── 单人课程
│   │   ├── 私教课程表
│   │   ├── 私教上课报表
│   │   └── 私教设置
│   └── 多人课程
│       ├── 团课课程表
│       ├── 团课上课报表
│       └── 课程模板
├── 👨‍🏫 教练管理
│   ├── 教练信息管理
│   ├── 教练排班
│   └── 教练业绩统计
├── 🏢 场地管理
│   ├── 场地排期表
│   ├── 场地设置
│   └── 场地租赁记录
├── 🎫 商品管理
│   ├── 会籍卡管理
│   ├── 私教课包管理
│   ├── 商品购买
│   ├── 售卖订单
│   └── 商品库存管理
├── 📊 数据中心
│   ├── 营业额统计
│   ├── 业绩分析
│   ├── 消耗统计
│   └── 出勤报表
├── 💰 财务管理
│   ├── 收费设置
│   ├── 综合签到
│   ├── 综合办理
│   └── 财务报表
├── 👨‍💼 员工管理
│   ├── 员工信息
│   ├── 岗位管理
│   └── 权限设置
└── ⚙️ 系统设置
    ├── 门店信息
    ├── 手机端设置
    ├── 小程序装修
    └── 偏好设置
```

### Web总部端

#### 核心功能
- **品牌管理**：多品牌创建、配置、管理
- **门店管理**：门店开设、关闭、配置
- **全局财务**：跨品牌财务统计和分析
- **人事管理**：员工管理、权限分配
- **数据分析**：全局数据统计和商业智能

---

## 🗄️ 数据库设计

### 核心数据表

#### 组织架构表
```sql
-- 品牌表
CREATE TABLE brands (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(100) NOT NULL COMMENT '品牌名称',
    logo VARCHAR(255) COMMENT '品牌Logo',
    description TEXT COMMENT '品牌描述',
    status TINYINT DEFAULT 1 COMMENT '状态：1-正常，0-停用',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);

-- 门店表
CREATE TABLE stores (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    brand_id BIGINT NOT NULL COMMENT '品牌ID',
    name VARCHAR(100) NOT NULL COMMENT '门店名称',
    address VARCHAR(255) COMMENT '门店地址',
    phone VARCHAR(20) COMMENT '联系电话',
    latitude DECIMAL(10,8) COMMENT '纬度',
    longitude DECIMAL(11,8) COMMENT '经度',
    status TINYINT DEFAULT 1 COMMENT '状态：1-营业，0-停业',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (brand_id) REFERENCES brands(id)
);
```

#### 用户权限表
```sql
-- 用户表
CREATE TABLE users (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    openid VARCHAR(100) UNIQUE COMMENT '微信OpenID',
    unionid VARCHAR(100) COMMENT '微信UnionID',
    phone VARCHAR(20) UNIQUE COMMENT '手机号',
    name VARCHAR(50) COMMENT '姓名',
    avatar VARCHAR(255) COMMENT '头像',
    gender TINYINT COMMENT '性别：1-男，2-女',
    birthday DATE COMMENT '生日',
    status TINYINT DEFAULT 1 COMMENT '状态：1-正常，0-禁用',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);

-- 员工表
CREATE TABLE employees (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id BIGINT NOT NULL COMMENT '用户ID',
    store_id BIGINT COMMENT '门店ID',
    brand_id BIGINT COMMENT '品牌ID',
    role_type ENUM('coach', 'receptionist', 'store_manager', 'brand_manager', 'admin') NOT NULL COMMENT '角色类型',
    employee_no VARCHAR(50) COMMENT '员工编号',
    hire_date DATE COMMENT '入职日期',
    status TINYINT DEFAULT 1 COMMENT '状态：1-在职，0-离职',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id),
    FOREIGN KEY (store_id) REFERENCES stores(id),
    FOREIGN KEY (brand_id) REFERENCES brands(id)
);
```

#### 会员业务表
```sql
-- 会员表
CREATE TABLE members (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id BIGINT NOT NULL COMMENT '用户ID',
    store_id BIGINT NOT NULL COMMENT '所属门店ID',
    member_no VARCHAR(50) UNIQUE COMMENT '会员编号',
    join_date DATE COMMENT '入会日期',
    status TINYINT DEFAULT 1 COMMENT '状态：1-正常，0-冻结',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id),
    FOREIGN KEY (store_id) REFERENCES stores(id)
);

-- 会籍卡表
CREATE TABLE membership_cards (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    member_id BIGINT NOT NULL COMMENT '会员ID',
    card_type VARCHAR(50) NOT NULL COMMENT '卡类型',
    card_name VARCHAR(100) NOT NULL COMMENT '卡名称',
    total_amount DECIMAL(10,2) COMMENT '总金额',
    paid_amount DECIMAL(10,2) COMMENT '已付金额',
    total_times INT COMMENT '总次数',
    used_times INT DEFAULT 0 COMMENT '已用次数',
    start_date DATE COMMENT '开始日期',
    end_date DATE COMMENT '结束日期',
    status TINYINT DEFAULT 1 COMMENT '状态：1-正常，2-过期，3-冻结',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (member_id) REFERENCES members(id)
);
```

---

## 🔧 开发规范

### 代码规范

#### 前端代码规范
- **命名规范**：
  - 组件名：PascalCase（如：`UserProfile`）
  - 文件名：kebab-case（如：`user-profile.vue`）
  - 变量名：camelCase（如：`userName`）
  - 常量名：UPPER_SNAKE_CASE（如：`API_BASE_URL`）

- **目录结构**：
```
src/
├── components/          # 公共组件
│   ├── common/         # 通用组件
│   └── business/       # 业务组件
├── pages/              # 页面组件
├── stores/             # 状态管理
├── utils/              # 工具函数
├── services/           # API服务
├── styles/             # 样式文件
└── types/              # TypeScript类型定义
```

#### 后端代码规范
- **API设计**：RESTful风格
- **响应格式**：统一JSON格式
```json
{
  "code": 200,
  "message": "success",
  "data": {},
  "timestamp": 1640995200000
}
```

### Git工作流
- **分支策略**：Git Flow
  - `main`：生产环境
  - `develop`：开发环境
  - `feature/*`：功能分支
  - `hotfix/*`：热修复分支

- **提交规范**：Conventional Commits
```
feat: 新功能
fix: 修复bug
docs: 文档更新
style: 代码格式调整
refactor: 代码重构
test: 测试相关
chore: 构建过程或辅助工具的变动
```

### 测试规范
- **单元测试**：覆盖率 > 80%
- **集成测试**：核心业务流程
- **E2E测试**：关键用户路径

---

## 🚀 部署指南

### 环境配置

#### 开发环境
- Node.js 18+
- MySQL 8.0
- Redis 6+
- 微信开发者工具

#### 生产环境
- 云服务器（4核8G起）
- 负载均衡器
- CDN加速
- SSL证书

### 部署流程

1. **代码构建**
```bash
# 前端构建
npm run build

# 后端构建
npm run build
```

2. **Docker部署**
```dockerfile
# Dockerfile示例
FROM node:18-alpine
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production
COPY . .
EXPOSE 3000
CMD ["npm", "start"]
```

3. **数据库迁移**
```bash
# 数据库初始化
npm run db:migrate
npm run db:seed
```

---

## 📈 项目里程碑

### Phase 1：基础架构（4周）
- [ ] 项目初始化和环境搭建
- [ ] 数据库设计和创建
- [ ] 基础API框架搭建
- [ ] 用户认证系统
- [ ] 权限管理系统

### Phase 2：核心功能（8周）
- [ ] 会员端小程序开发
- [ ] 门店端小程序开发
- [ ] Web门店端开发
- [ ] 基础业务功能实现

### Phase 3：高级功能（6周）
- [ ] Web总部端开发
- [ ] 数据统计和分析
- [ ] 财务管理模块
- [ ] 系统集成测试

### Phase 4：优化上线（4周）
- [ ] 性能优化
- [ ] 安全加固
- [ ] 生产环境部署
- [ ] 用户培训和文档

---

## 🔒 安全考虑

### 数据安全
- **数据加密**：敏感数据加密存储
- **传输安全**：HTTPS + API签名
- **访问控制**：基于角色的权限控制
- **数据备份**：定期自动备份

### 系统安全
- **输入验证**：所有用户输入严格验证
- **SQL注入防护**：使用参数化查询
- **XSS防护**：输出内容转义
- **CSRF防护**：Token验证

---

## 📞 技术支持

### 开发团队联系方式
- **项目经理**：[联系方式]
- **技术负责人**：[联系方式]
- **UI设计师**：[联系方式]

### 相关文档
- [API接口文档]
- [数据库设计文档]
- [部署运维文档]
- [用户使用手册]

---

*本文档将随项目进展持续更新，请关注最新版本。*